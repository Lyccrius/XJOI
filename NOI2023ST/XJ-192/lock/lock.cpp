#include<stdio.h>
int main()
{
	freopen("lock.in","r",stdin);
	freopen("lock.out","w",stdout);
	int a[50005][5]={0},n,i,j,k,s,d,b,l,min,smin,max,c[5]={0},ans;
	scanf("%d%d",&d,&k);
	for(l=1;l<=d;l++)
	{
		ans=0;
		for(i=1;i<=4;i++)
		{
			c[i]=0;
		}
		scanf("%d",&n);
		for(i=1;i<=k;i++)
		{
			for(j=1;j<=n;j++)
			{
				scanf("%d",&a[i][j]);
			}
		}
		for(i=2;i<=n;i++)
		{
			s=a[1][i];
			for(b=1;b<=k-1;b++)
			{
				a[b][i]=a[b+1][i];
			}
			a[k][i]=s;
			s=0;
			for(b=1;b<=k;b++)
			{
				if(a[b][i]-a[b][i-1]<0)
				{
					if(s<a[b][i-1]-a[b][i])
					{
						s=a[b][i-1]-a[b][i];
					}
				}
				else
				{
					if(s<a[b][i]-a[b][i-1])
					{
						s=a[b][i]-a[b][i-1];
					}
				}
			}
			min=s;
			smin=1;
			for(j=2;j<=k;j++)
			{
				s=a[1][i];
				for(b=1;b<=k-1;b++)
				{
					a[b][i]=a[b+1][i];
				}
				a[k][i]=s;
				s=0;
				for(b=1;b<=k;b++)
				{
					if(a[b][i]-a[b][i-1]<0)
					{
						if(s<a[b][i-1]-a[b][i])
						{
							s=a[b][i-1]-a[b][i];
						}
					}
					else
					{
						if(s<a[b][i]-a[b][i-1])
						{
							s=a[b][i]-a[b][i-1];
						}
					}
				}
				if(s<min)
				{
					min=s;
					smin=j;
				}
			}
			for(j=1;j<=smin;j++)
			{
				s=a[1][i];
				for(b=1;b<=k-1;b++)
				{
					a[b][i]=a[b+1][i];
				}
				a[k][i]=s;
			}
		}
		for(i=1;i<=k;i++)
		{
			min=a[i][1];
			max=a[i][1];
			for(j=1;j<=n;j++)
			{
				if(a[i][j]>max)
				{
					max=a[i][j];
				}
				if(a[i][j]<min)
				{
					min=a[i][j];
				}
			}
			c[i]=max-min;
		}
		ans=c[1];
		for(i=2;i<=k;i++)
		{
			if(c[i]>ans)
			{
				ans=c[i];
			}
		}
		printf("%d\n",ans);
	}
	return 0;
}
